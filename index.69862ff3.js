function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},i=t.parcelRequired7c6;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},t.parcelRequired7c6=i);var a=i("eWCmQ");const r={modalFilmImg:document.querySelector(".modal__img"),modalFilmTitle:document.querySelector(".modal-film__title"),modalFilmVote:document.querySelector(".vote"),modalFilmVotes:document.querySelector(".votes"),modalFilmPopularity:document.querySelector(".popularity"),modalFilmOrigTitle:document.querySelector(".orig-title"),modalFilmGenre:document.querySelector(".genre"),modalFilmDescription:document.querySelector(".about__text"),modalFilmWatched:document.querySelector(".button-watched"),modalFilmQueue:document.querySelector(".button-queue"),gallery:document.querySelector(".card"),paginationList:document.querySelector(".pagination-mid"),pageList:document.querySelector(".pages"),lastBtn:document.getElementById("last-page"),prevBtn:document.getElementById("button-prev"),nextBtn:document.getElementById("button-next"),firstPage:document.querySelector(".first"),lastPage:document.querySelector(".last")};a=i("eWCmQ");const l=document.querySelector(".card"),s=document.querySelector(".backdrop"),d=document.querySelector(".close-button");function c(){s.classList.add("is-hidden"),document.body.style.overflow="visible"}function u(e){"Escape"===e.code&&(document.removeEventListener("keydown",u),c())}l.addEventListener("click",(function(e){if(e.preventDefault(!e.target.closest("li")))return void e.preventDefault();if(e.target.closest("li")){(function(e){return fetch(`https://api.themoviedb.org/3/movie/${e}?api_key=0f09f0e29eb26a1e28b4809ac59dbd60`).then((e=>{if(!e.ok)throw new Error;return e.json()})).catch((e=>a.Notify.failure("Sorry, something goes wrong. Please, try again")))})(e.target.closest("a").getAttribute("id")).then((e=>function(e){const t=e.genres.map((e=>e.name)).join(", ");let n=localStorage.getItem("watch");n=n?JSON.parse(n):[];const o=n.find((t=>t.id===e.id));let i=localStorage.getItem("queue");i=i?JSON.parse(i):[];const a=i.find((t=>t.id===e.id));r.modalFilmImg.src=`https://image.tmdb.org/t/p/w500/${e.poster_path}`,r.modalFilmImg.alt=`${e.title} poster`,r.modalFilmTitle.textContent=e.title,r.modalFilmTitle.filmId=e.id,r.modalFilmVote.textContent=e.vote_average,r.modalFilmVotes.textContent=e.vote_count,r.modalFilmPopularity.textContent=e.popularity,r.modalFilmOrigTitle.textContent=e.original_title,r.modalFilmDescription.textContent=e.overview,r.modalFilmGenre.textContent=t,r.modalFilmWatched.dataset.info=JSON.stringify(e),r.modalFilmQueue.dataset.info=JSON.stringify(e),r.modalFilmWatched.textContent=o?"REMOVED FORM WATCHED":"ADD TO WATCHED",r.modalFilmQueue.textContent=a?"REMOVED FORM QUEUE":"ADD TO QUEUE"}(e))),document.body.style.overflow="hidden",s.classList.remove("is-hidden"),document.addEventListener("keydown",u)}})),d.addEventListener("click",c),s.addEventListener("click",(function(e){e.currentTarget===e.target&&c()}));document.querySelector(".modal-film");const m=document.querySelector(".button-watched"),g=document.querySelector(".button-queue");m.addEventListener("click",(function(t){const n=JSON.parse(t.target.dataset.info);console.log(t.target.dataset.info);let o=localStorage.getItem("watch");console.log(o),o=o?JSON.parse(o):[];o.find((e=>e.id===n.id))?(o=o.filter((e=>e.id!==n.id)),r.modalFilmWatched.textContent="ADD TO WATCH",e(a).Notify.failure("Film remove from watch")):(o.push(n),r.modalFilmWatched.textContent="REMOVE FROM WATCH",e(a).Notify.success("Film add to watch"));localStorage.setItem("watch",JSON.stringify(o))})),g.addEventListener("click",(function(t){const n=JSON.parse(t.target.dataset.info);console.log(t);let o=localStorage.getItem("queue");console.log(o),o=o?JSON.parse(o):[];o.find((e=>e.id===n.id))?(o=o.filter((e=>e.id!==n.id)),r.modalFilmQueue.textContent="ADD TO QUEUE",e(a).Notify.failure("Film remove from watch")):(o.push(n),r.modalFilmQueue.textContent="REMOVE FROM QUEUE",e(a).Notify.success("Film add to queue"));localStorage.setItem("queue",JSON.stringify(o))}));const h=new class{fetchPopularMovies(){const e=`https://api.themoviedb.org/3/trending/movie/day?api_key=cf7103a04560136cfec7834a7d0f8600&page=${this.page}`;return fetch(e).then((e=>e.json()))}fetchMoviesByRequest(){const e=`https://api.themoviedb.org/3/search/movie?api_key=cf7103a04560136cfec7834a7d0f8600&language=en-US&query=${this.searchQuery}&page=${this.page}&include_adult=false`;return fetch(e).then((e=>e.json()))}fetchMovieDetails(e){return fetch(`https://api.themoviedb.org/3/movie/${e}?api_key=cf7103a04560136cfec7834a7d0f8600&language=en-US`).then((e=>e.json())).then((e=>e))}fatchTrailerSearch(e){return fetch(`https://api.themoviedb.org/3/movie/${e}/videos?api_key=cf7103a04560136cfec7834a7d0f8600&language=en-US`).then((e=>e.json())).then((e=>e))}incrementPage(){this.page+=1}resetPage(){this.page=1}get query(){return this.searchQuery}set query(e){this.searchQuery=e}clearInput(){this.searchQuery.innerHTML=""}pagination(e){this.page=e}constructor(){this.page=1,this.searchQuery=""}};console.log(h);const p=document.querySelector("#search-form");document.querySelector(".container"),document.querySelector(".search-form__input"),document.querySelector(".search-form__button");let f,y=1;function _(e){return e.map((e=>{for(let t=0;t<e.genre_ids.length;t++)v(e.genre_ids[t])?(e.genre_ids[t]=` ${v(e.genre_ids[t])}`,e.genre_ids.length>2&&e.genre_ids.splice(2,5," Other")):(e.genre_ids[t]=" Other genre",e.genre_ids.length>2&&e.genre_ids.splice(2,5," Other"));return e.release_date?e.release_date=e.release_date.slice(0,4):e.first_air_date&&(e.release_date=e.first_air_date.slice(0,4)),e.original_title||(e.original_title=e.name),e.poster_path?e.poster_path="https://image.tmdb.org/t/p/original/"+e.poster_path:e.poster_path="https://w.zhinka.tv/templates/Default/dleimages/no_image.jpg",e}))}function v(e){let t;return[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:36,name:"History"},{id:27,name:"Horror"},{id:10402,name:"Music"},{id:9648,name:"Mystery"},{id:10749,name:"Romance"},{id:878,name:"Science Fiction"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"War"},{id:37,name:"Western"}].forEach((n=>{e==n.id&&(t=n.name)})),t}function b(e){const t=S(e);refs.gallery.insertAdjacentHTML("beforeend",movieMarkup(t))}function S(e){return e.map((({first_air_date:e,id:t,name:n,backdrop_path:o,original_title:i,genre_ids:a,poster_path:r,release_date:l})=>({first_air_date:e,id:t,name:n,backdrop_path:o,original_title:i,genre_ids:a,poster_path:r,release_date:l,dataMovie:JSON.stringify({first_air_date:e,id:t,name:n,backdrop_path:o,original_title:i,genre_ids:a,poster_path:r,release_date:l})})))}function q(){refs.preloader.classList.contains("done")||refs.preloader.classList.add("done")}p.addEventListener("submit",(function(e){if(e.preventDefault(),h.query=e.currentTarget.elements.query.value,""===h.query.trim())return toastr.warning("Пожалуйста, введите ваш запроc");refs.gallery.innerHTML="",function(e){e.currentTarget.elements.query.value=""}(e),refs.pageList.innerHTML="",refs.preloader.classList.remove("done"),h.resetPage(),y=1,h.fetchMoviesByRequest().then((e=>(f=e.total_pages,refs.lastBtn.textContent=f,init(),e.results))).then((e=>{e.length<1&&(toastr.error("Фильм не найден! Измените ввод и повторите попытку"),h.query="",h.fetchPopularMovies().then((e=>(f=e.total_pages,refs.lastBtn.textContent=f,init(),e.results))).then((e=>{b(_(S(e))),setTimeout(q,200)})).catch((e=>console.log(e)))),b(_(S(e))),setTimeout(q,200)})).catch((e=>console.log(e)))}));const L={openFooterModal:document.querySelector('[data-action="open-lightbox"]'),closeFooterModal:document.querySelector('[data-action="close-lightbox"]'),lightboxFooterModal:document.querySelector(".js-lightbox"),backdropClick:document.querySelector(".lightbox"),body:document.querySelector("body")};function F(){window.removeEventListener("keydown",w),L.lightboxFooterModal.classList.add("visually-hidden"),L.body.classList.remove("on-scroll")}function w(e){"Escape"===e.code&&(F(),L.body.classList.remove("on-scroll"))}L.openFooterModal.addEventListener("click",(function(){window.addEventListener("keydown",w),L.lightboxFooterModal.classList.remove("visually-hidden"),L.body.classList.add("on-scroll")})),L.closeFooterModal.addEventListener("click",F),L.backdropClick.addEventListener("click",(function(e){e.currentTarget===e.target&&(F(),L.body.classList.remove("on-scroll"))}));const E=document.querySelector(".card");let x;function M(e){e.results.map((e=>{let t=new Date(e.release_date).getFullYear(),n=function(e){let t=[];return e.forEach((e=>{t.push(x.find((t=>t.id===e)).name)})),t}(e.genre_ids);return E.innerHTML+=`<li class="card__item item">\n\n                  <a class="card__link link" href="#" id="${e.id}" data-id="${e.id}" data-film-open>\n                    <div class="card__thumb">\n                      <img class="card__img"                      \n                        sizes="(min-width: 1200px) 370px, (min-width: 768px) 354px, (max-width: 767px) 450px, 100vw"\n                        src='https://www.themoviedb.org/t/p/w500/${e.poster_path}'\n                        alt="tehnocryak"\n                        width="100%"\n                        class="card__img"\n                      />\n                    </div>\n                    <div class="card__meta">\n                      <h2 class="card__title">${e.original_title}</h2>\n                      <p class="card__info">${n} | ${t}</p>\n                    </div>\n                  </a>\n                </li>`}))}fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=177f83f5259c7f846e561f4715bd03a4&language=en-US").then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()})).then((e=>(x=e.genres,x))).catch((e=>console.log(e))),window.onload=function(){document.body.classList.add("loaded_hiding"),window.setTimeout((function(){document.body.classList.add("loaded"),document.body.classList.remove("loaded_hiding")}),500)};const T=new class{fetchPopularMovies(){const e=`https://api.themoviedb.org/3/trending/movie/day?api_key=0f09f0e29eb26a1e28b4809ac59dbd60&page=${this.page}`;return fetch(e).then((e=>e.json()))}incrementPage(){this.page+=1}resetPage(){this.page=1}get query(){return this.searchQuery}set query(e){this.searchQuery=e}clearInput(){this.searchQuery.innerHTML=""}pagination(e){this.page=e}constructor(){this.page=1,this.searchQuery=""}};let k,O=1;function C(){T.fetchPopularMovies().then((e=>{k=e.total_pages,r.lastBtn.textContent=k,r.prevBtn.disabled=1===O,r.nextBtn.disabled=O===k,r.firstPage.hidden=O<4,r.lastPage.hidden=O>k-3,function(){const e=O+2;for(let t=O-2;t<=e;t+=1)t>0&&t<=k&&r.pageList.insertAdjacentHTML("beforeend",`<li class="pages-item"><button type="button" class="pagination-btn">${t}</button></li>`)}(),function(){let e=r.pageList.querySelectorAll("button");for(let t=0;t<e.length;t+=1)Number(e[t].textContent)===O&&e[t].classList.add("active-btn")}(),M(e)})).catch((e=>console.log(e)))}r.paginationList.addEventListener("click",(function(e){if(e.preventDefault(),"BUTTON"!==e.target.nodeName)return;r.gallery.innerHTML="",r.pageList.innerHTML="",O=Number(e.target.textContent),T.pagination(O),T.query?searchFetch():C()})),r.prevBtn.addEventListener("click",(function(e){e.preventDefault(),O>1&&(O-=1);r.gallery.innerHTML="",r.pageList.innerHTML="",T.pagination(O),T.query?searchFetch():C()})),r.nextBtn.addEventListener("click",(function(e){e.preventDefault(),O!==k&&(O+=1);r.gallery.innerHTML="",r.pageList.innerHTML="",T.pagination(O),T.query?searchFetch():C()})),T.pagination(O),C();
//# sourceMappingURL=index.69862ff3.js.map
