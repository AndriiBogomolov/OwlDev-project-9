!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},r=t.parcelRequired7c6;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},t.parcelRequired7c6=r);var i=r("iU1Pc"),a={modalFilmImg:document.querySelector(".modal__img"),modalFilmId:document.querySelector(".modal-film__id"),modalFilmTitle:document.querySelector(".modal-film__title"),modalFilmVote:document.querySelector(".vote"),modalFilmVotes:document.querySelector(".votes"),modalFilmPopularity:document.querySelector(".popularity"),modalFilmOrigTitle:document.querySelector(".orig-title"),modalFilmGenre:document.querySelector(".genre"),modalFilmDescription:document.querySelector(".about__text"),modalTrailerWatch:document.querySelector(".modal__watch"),modalFilmWatched:document.querySelector(".button-watched"),modalFilmQueue:document.querySelector(".button-queue"),gallery:document.querySelector(".card"),paginationList:document.querySelector(".pagination-mid"),pageList:document.querySelector(".pages"),lastBtn:document.getElementById("last-page"),prevBtn:document.getElementById("button-prev"),nextBtn:document.getElementById("button-next"),firstPage:document.querySelector(".first"),lastPage:document.querySelector(".last")},c="0f09f0e29eb26a1e28b4809ac59dbd60",l="https://api.themoviedb.org/3",u=(i=r("iU1Pc"),document.querySelector(".card")),s=document.querySelector(".backdrop"),d=document.querySelector(".close-button");function f(){s.classList.add("is-hidden"),document.body.style.overflow="visible"}function m(e){"Escape"===e.code&&(document.removeEventListener("keydown",m),f())}u.addEventListener("click",(function(e){if(e.preventDefault(!e.target.closest("li")))return void e.preventDefault();e.target.closest("li")&&(function(e){return fetch("".concat(l,"/movie/").concat(e,"?api_key=").concat(c)).then((function(e){if(!e.ok)throw new Error;return e.json()})).catch((function(e){return i.Notify.failure("Sorry, something goes wrong. Please, try again")}))}(e.target.closest("a").getAttribute("id")).then((function(e){return n=(t=e).genres.map((function(e){return e.name})).join(", "),o=localStorage.getItem("watch"),r=(o=o?JSON.parse(o):[]).find((function(e){return e.id===t.id})),i=localStorage.getItem("queue"),c=(i=i?JSON.parse(i):[]).find((function(e){return e.id===t.id})),a.modalFilmImg.src="https://image.tmdb.org/t/p/w500/".concat(t.poster_path),a.modalFilmImg.alt="".concat(t.title," poster"),a.modalFilmTitle.textContent=t.title,a.modalFilmId.textContent=t.id,a.modalFilmVote.textContent=t.vote_average,a.modalFilmVotes.textContent=t.vote_count,a.modalFilmPopularity.textContent=t.popularity,a.modalFilmOrigTitle.textContent=t.original_title,a.modalFilmDescription.textContent=t.overview,a.modalFilmGenre.textContent=n,a.modalFilmWatched.dataset.info=JSON.stringify(t),a.modalFilmQueue.dataset.info=JSON.stringify(t),a.modalFilmWatched.textContent=r?"REMOVED FORM WATCHED":"ADD TO WATCHED",void(a.modalFilmQueue.textContent=c?"REMOVED FORM QUEUE":"ADD TO QUEUE");var t,n,o,r,i,c})),document.body.style.overflow="hidden",s.classList.remove("is-hidden"),document.addEventListener("keydown",m))})),d.addEventListener("click",f),s.addEventListener("click",(function(e){e.currentTarget===e.target&&f()}));document.querySelector(".modal-film");var h=document.querySelector(".button-watched"),g=document.querySelector(".button-queue");h.addEventListener("click",(function(t){var n=JSON.parse(t.target.dataset.info);console.log(t.target.dataset.info);var o=localStorage.getItem("watch");console.log(o),o=o?JSON.parse(o):[];o.find((function(e){return e.id===n.id}))?(o=o.filter((function(e){return e.id!==n.id})),a.modalFilmWatched.textContent="ADD TO WATCH",e(i).Notify.failure("Film remove from watch")):(o.push(n),a.modalFilmWatched.textContent="REMOVE FROM WATCH",e(i).Notify.success("Film add to watch"));localStorage.setItem("watch",JSON.stringify(o))})),g.addEventListener("click",(function(t){var n=JSON.parse(t.target.dataset.info);console.log(t);var o=localStorage.getItem("queue");console.log(o),o=o?JSON.parse(o):[];o.find((function(e){return e.id===n.id}))?(o=o.filter((function(e){return e.id!==n.id})),a.modalFilmQueue.textContent="ADD TO QUEUE",e(i).Notify.failure("Film remove from watch")):(o.push(n),a.modalFilmQueue.textContent="REMOVE FROM QUEUE",e(i).Notify.success("Film add to queue"));localStorage.setItem("queue",JSON.stringify(o))}));var p={};Object.defineProperty(p,"__esModule",{value:!0}),p.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var v={};function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}Object.defineProperty(v,"__esModule",{value:!0}),v.default=function(e,t,n){t&&y(e.prototype,t);n&&y(e,n);return e};var b="https://api.themoviedb.org/3",_="cf7103a04560136cfec7834a7d0f8600",w=new(function(){"use strict";function t(){e(p)(this,t),this.page=1,this.searchQuery=""}return e(v)(t,[{key:"fetchPopularMovies",value:function(){var e="".concat(b,"/trending/movie/day?api_key=").concat(_,"&page=").concat(this.page);return fetch(e).then((function(e){return e.json()}))}},{key:"fetchMoviesByRequest",value:function(){var e="".concat(b,"/search/movie?api_key=").concat(_,"&language=en-US&query=").concat(this.searchQuery,"&page=").concat(this.page,"&include_adult=false");return fetch(e).then((function(e){return e.json()}))}},{key:"fetchMovieDetails",value:function(e){var t="".concat(b,"/movie/").concat(e,"?api_key=").concat(_,"&language=en-US");return fetch(t).then((function(e){return e.json()})).then((function(e){return e}))}},{key:"fatchTrailerSearch",value:function(e){var t="".concat(b,"/movie/").concat(e,"/videos?api_key=").concat(_,"&language=en-US");return fetch(t).then((function(e){return e.json()})).then((function(e){return e}))}},{key:"incrementPage",value:function(){this.page+=1}},{key:"resetPage",value:function(){this.page=1}},{key:"query",get:function(){return this.searchQuery},set:function(e){this.searchQuery=e}},{key:"clearInput",value:function(){this.searchQuery.innerHTML=""}},{key:"pagination",value:function(e){this.page=e}}]),t}());console.log(w);var L,S=document.querySelector("#search-form");document.querySelector(".container"),document.querySelector(".search-form__input"),document.querySelector(".search-form__button");function k(e){return e.map((function(e){for(var t=0;t<e.genre_ids.length;t++)E(e.genre_ids[t])?(e.genre_ids[t]=" ".concat(E(e.genre_ids[t])),e.genre_ids.length>2&&e.genre_ids.splice(2,5," Other")):(e.genre_ids[t]=" Other genre",e.genre_ids.length>2&&e.genre_ids.splice(2,5," Other"));return e.release_date?e.release_date=e.release_date.slice(0,4):e.first_air_date&&(e.release_date=e.first_air_date.slice(0,4)),e.original_title||(e.original_title=e.name),e.poster_path?e.poster_path="https://image.tmdb.org/t/p/original/"+e.poster_path:e.poster_path="https://w.zhinka.tv/templates/Default/dleimages/no_image.jpg",e}))}function E(e){var t;return[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:36,name:"History"},{id:27,name:"Horror"},{id:10402,name:"Music"},{id:9648,name:"Mystery"},{id:10749,name:"Romance"},{id:878,name:"Science Fiction"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"War"},{id:37,name:"Western"}].forEach((function(n){e==n.id&&(t=n.name)})),t}function x(e){var t=q(e);refs.gallery.insertAdjacentHTML("beforeend",movieMarkup(t))}function q(e){return e.map((function(e){var t=e.first_air_date,n=e.id,o=e.name,r=e.backdrop_path,i=e.original_title,a=e.genre_ids,c=e.poster_path,l=e.release_date;return{first_air_date:t,id:n,name:o,backdrop_path:r,original_title:i,genre_ids:a,poster_path:c,release_date:l,dataMovie:JSON.stringify({first_air_date:t,id:n,name:o,backdrop_path:r,original_title:i,genre_ids:a,poster_path:c,release_date:l})}}))}function F(){refs.preloader.classList.contains("done")||refs.preloader.classList.add("done")}S.addEventListener("submit",(function(e){if(e.preventDefault(),w.query=e.currentTarget.elements.query.value,""===w.query.trim())return toastr.warning("Пожалуйста, введите ваш запроc");refs.gallery.innerHTML="",function(e){e.currentTarget.elements.query.value=""}(e),refs.pageList.innerHTML="",refs.preloader.classList.remove("done"),w.resetPage(),1,w.fetchMoviesByRequest().then((function(e){return L=e.total_pages,refs.lastBtn.textContent=L,init(),e.results})).then((function(e){e.length<1&&(toastr.error("Фильм не найден! Измените ввод и повторите попытку"),w.query="",w.fetchPopularMovies().then((function(e){return L=e.total_pages,refs.lastBtn.textContent=L,init(),e.results})).then((function(e){x(k(q(e))),setTimeout(F,200)})).catch((function(e){return console.log(e)}))),x(k(q(e))),setTimeout(F,200)})).catch((function(e){return console.log(e)}))}));var M={openFooterModal:document.querySelector('[data-action="open-lightbox"]'),closeFooterModal:document.querySelector('[data-action="close-lightbox"]'),lightboxFooterModal:document.querySelector(".js-lightbox"),backdropClick:document.querySelector(".lightbox"),body:document.querySelector("body")};function T(){window.removeEventListener("keydown",O),M.lightboxFooterModal.classList.add("visually-hidden"),M.body.classList.remove("on-scroll")}function O(e){"Escape"===e.code&&(T(),M.body.classList.remove("on-scroll"))}M.openFooterModal.addEventListener("click",(function(){window.addEventListener("keydown",O),M.lightboxFooterModal.classList.remove("visually-hidden"),M.body.classList.add("on-scroll")})),M.closeFooterModal.addEventListener("click",T),M.backdropClick.addEventListener("click",(function(e){e.currentTarget===e.target&&(T(),M.body.classList.remove("on-scroll"))}));var C,D=document.querySelector(".card");function N(e){e.results.map((function(e){var t=new Date(e.release_date).getFullYear(),n=function(e){var t=[];return e.forEach((function(e){t.push(C.find((function(t){return t.id===e})).name)})),t}(e.genre_ids);return D.innerHTML+='<li class="card__item item">\n\n                  <a class="card__link link" href="#" id="'.concat(e.id,'" data-id="').concat(e.id,'" data-film-open>\n                    <div class="card__thumb">\n                      <img class="card__img"                      \n                        sizes="(min-width: 1200px) 370px, (min-width: 768px) 354px, (max-width: 767px) 450px, 100vw"\n                        src=\'https://www.themoviedb.org/t/p/w500/').concat(e.poster_path,'\'\n                        alt="tehnocryak"\n                        width="100%"\n                        class="card__img"\n                      />\n                    </div>\n                    <div class="card__meta">\n                      <h2 class="card__title">').concat(e.original_title,'</h2>\n                      <p class="card__info">').concat(n," | ").concat(t,"</p>\n                    </div>\n                  </a>\n                </li>")}))}fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=177f83f5259c7f846e561f4715bd03a4&language=en-US").then((function(e){if(!e.ok)throw new Error(e.statusText);return e.json()})).then((function(e){return C=e.genres})).catch((function(e){return console.log(e)})),window.onload=function(){document.body.classList.add("loaded_hiding"),window.setTimeout((function(){document.body.classList.add("loaded"),document.body.classList.remove("loaded_hiding")}),500)};var P={};P=function e(t,n,o){function r(a,c){if(!n[a]){if(!t[a]){var l=void 0;if(!c&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var s=n[a]={exports:{}};t[a][0].call(s.exports,(function(e){return r(t[a][1][e]||e)}),s,s.exports,e,t,n,o)}return n[a].exports}for(var i=void 0,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.create=n.visible=void 0;var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.createElement("div");return n.innerHTML=e.trim(),!0===t?n.children:n.firstChild},r=function(e,t){var n=e.children;return 1===n.length&&n[0].tagName===t},i=function(e){return null!=(e=e||document.querySelector(".basicLightbox"))&&!0===e.ownerDocument.body.contains(e)};n.visible=i,n.create=function(e,t){var n=function(e,t){var n=o('\n\t\t<div class="basicLightbox '.concat(t.className,'">\n\t\t\t<div class="basicLightbox__placeholder" role="dialog"></div>\n\t\t</div>\n\t')),i=n.querySelector(".basicLightbox__placeholder");e.forEach((function(e){return i.appendChild(e)}));var a=r(i,"IMG"),c=r(i,"VIDEO"),l=r(i,"IFRAME");return!0===a&&n.classList.add("basicLightbox--img"),!0===c&&n.classList.add("basicLightbox--video"),!0===l&&n.classList.add("basicLightbox--iframe"),n}(e=function(e){var t="string"==typeof e,n=e instanceof HTMLElement==1;if(!1===t&&!1===n)throw new Error("Content must be a DOM element/node or string");return!0===t?Array.from(o(e,!0)):"TEMPLATE"===e.tagName?[e.content.cloneNode(!0)]:Array.from(e.children)}(e),t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==(e=Object.assign({},e)).closable&&(e.closable=!0),null==e.className&&(e.className=""),null==e.onShow&&(e.onShow=function(){}),null==e.onClose&&(e.onClose=function(){}),"boolean"!=typeof e.closable)throw new Error("Property `closable` must be a boolean");if("string"!=typeof e.className)throw new Error("Property `className` must be a string");if("function"!=typeof e.onShow)throw new Error("Property `onShow` must be a function");if("function"!=typeof e.onClose)throw new Error("Property `onClose` must be a function");return e}(t)),a=function(e){return!1!==t.onClose(c)&&function(e,t){return e.classList.remove("basicLightbox--visible"),setTimeout((function(){return!1===i(e)||e.parentElement.removeChild(e),t()}),410),!0}(n,(function(){if("function"==typeof e)return e(c)}))};!0===t.closable&&n.addEventListener("click",(function(e){e.target===n&&a()}));var c={element:function(){return n},visible:function(){return i(n)},show:function(e){return!1!==t.onShow(c)&&function(e,t){return document.body.appendChild(e),setTimeout((function(){requestAnimationFrame((function(){return e.classList.add("basicLightbox--visible"),t()}))}),10),!0}(n,(function(){if("function"==typeof e)return e(c)}))},close:a};return c}},{}]},{},[1])(1);i=r("iU1Pc");a.modalTrailerWatch.addEventListener("click",(function(e){e.preventDefault(),function(e){(function(e){return fetch("".concat(l,"/movie/").concat(e,"/videos?api_key=").concat(c)).then((function(e){if(!e.ok)throw new Error;return e.json()})).catch((function(e){return i.Notify.failure("Sorry, something goes wrong. Please, try again")}))})(e).then((function(e){if(void 0!==e.results.lenght){var t=e.results.filter((function(t){return t.official?t.official:e.results[0].key}))[0].key,n=P.create('\n      <iframe src="https://www.youtube.com/embed/'.concat(t,'" width="560" height="315" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>\n  '));n.show(),function(e){document.querySelector(".basicLightbox--iframe").insertAdjacentHTML("afterbegin",'<button\n        type="button"\n        class="modal-film__btn trailer-btn"\n        data-trailer-close\n        >\n        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M8 8L22 22" stroke="black" stroke-width="2"/>\n        <path d="M8 22L22 8" stroke="black" stroke-width="2"/>\n        </svg>\n        </button>\n    '),document.querySelector("[data-trailer-close]").addEventListener("click",(function(t){e.close()}))}(n)}}))}(a.modalFilmId.textContent)}));var H,A=new(function(){"use strict";function t(){e(p)(this,t),this.page=1,this.searchQuery=""}return e(v)(t,[{key:"fetchPopularMovies",value:function(){var e="".concat(l,"/trending/movie/day?api_key=").concat(c,"&page=").concat(this.page);return fetch(e).then((function(e){return e.json()}))}},{key:"incrementPage",value:function(){this.page+=1}},{key:"resetPage",value:function(){this.page=1}},{key:"query",get:function(){return this.searchQuery},set:function(e){this.searchQuery=e}},{key:"clearInput",value:function(){this.searchQuery.innerHTML=""}},{key:"pagination",value:function(e){this.page=e}}]),t}()),I=1;function U(){A.fetchPopularMovies().then((function(e){H=e.total_pages,a.lastBtn.textContent=H,a.prevBtn.disabled=1===I,a.nextBtn.disabled=I===H,a.firstPage.hidden=I<4,a.lastPage.hidden=I>H-3,function(){for(var e=I+2,t=I-2;t<=e;t+=1)t>0&&t<=H&&a.pageList.insertAdjacentHTML("beforeend",'<li class="pages-item"><button type="button" class="pagination-btn">'.concat(t,"</button></li>"))}(),function(){for(var e=a.pageList.querySelectorAll("button"),t=0;t<e.length;t+=1)Number(e[t].textContent)===I&&e[t].classList.add("active-btn")}(),N(e)})).catch((function(e){return console.log(e)}))}a.paginationList.addEventListener("click",(function(e){if(e.preventDefault(),"BUTTON"!==e.target.nodeName)return;a.gallery.innerHTML="",a.pageList.innerHTML="",I=Number(e.target.textContent),A.pagination(I),A.query?searchFetch():U()})),a.prevBtn.addEventListener("click",(function(e){e.preventDefault(),I>1&&(I-=1);a.gallery.innerHTML="",a.pageList.innerHTML="",A.pagination(I),A.query?searchFetch():U()})),a.nextBtn.addEventListener("click",(function(e){e.preventDefault(),I!==H&&(I+=1);a.gallery.innerHTML="",a.pageList.innerHTML="",A.pagination(I),A.query?searchFetch():U()})),A.pagination(I),U()}();
//# sourceMappingURL=index.8ad28fe4.js.map
