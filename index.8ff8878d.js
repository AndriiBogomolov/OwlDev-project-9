function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},o={},r=t.parcelRequired7c6;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in o){var t=o[e];delete o[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},t.parcelRequired7c6=r);var i=r("eWCmQ");const a={modalFilmImg:document.querySelector(".modal__img"),modalFilmId:document.querySelector(".modal-film__id"),modalFilmTitle:document.querySelector(".modal-film__title"),modalFilmVote:document.querySelector(".vote"),modalFilmVotes:document.querySelector(".votes"),modalFilmPopularity:document.querySelector(".popularity"),modalFilmOrigTitle:document.querySelector(".orig-title"),modalFilmGenre:document.querySelector(".genre"),modalFilmDescription:document.querySelector(".about__text"),modalTrailerWatch:document.querySelector(".modal__watch"),modalFilmWatched:document.querySelector(".button-watched"),modalFilmQueue:document.querySelector(".button-queue"),gallery:document.querySelector(".card"),paginationList:document.querySelector(".pagination-mid"),pageList:document.querySelector(".pages"),lastBtn:document.getElementById("last-page"),prevBtn:document.getElementById("button-prev"),nextBtn:document.getElementById("button-next"),firstPage:document.querySelector(".first"),lastPage:document.querySelector(".last")};i=r("eWCmQ");const l=document.querySelector(".card"),c=document.querySelector(".backdrop"),s=document.querySelector(".close-button");function d(){c.classList.add("is-hidden"),document.body.style.overflow="visible"}function u(e){"Escape"===e.code&&(document.removeEventListener("keydown",u),d())}l.addEventListener("click",(function(e){if(e.preventDefault(!e.target.closest("li")))return void e.preventDefault();if(e.target.closest("li")){(function(e){return fetch(`https://api.themoviedb.org/3/movie/${e}?api_key=0f09f0e29eb26a1e28b4809ac59dbd60`).then((e=>{if(!e.ok)throw new Error;return e.json()})).catch((e=>i.Notify.failure("Sorry, something goes wrong. Please, try again")))})(e.target.closest("a").getAttribute("id")).then((e=>function(e){const t=e.genres.map((e=>e.name)).join(", ");let n=localStorage.getItem("watch");n=n?JSON.parse(n):[];const o=n.find((t=>t.id===e.id));let r=localStorage.getItem("queue");r=r?JSON.parse(r):[];const i=r.find((t=>t.id===e.id));a.modalFilmImg.src=`https://image.tmdb.org/t/p/w500/${e.poster_path}`,a.modalFilmImg.alt=`${e.title} poster`,a.modalFilmTitle.textContent=e.title,a.modalFilmId.textContent=e.id,a.modalFilmVote.textContent=e.vote_average,a.modalFilmVotes.textContent=e.vote_count,a.modalFilmPopularity.textContent=e.popularity,a.modalFilmOrigTitle.textContent=e.original_title,a.modalFilmDescription.textContent=e.overview,a.modalFilmGenre.textContent=t,a.modalFilmWatched.dataset.info=JSON.stringify(e),a.modalFilmQueue.dataset.info=JSON.stringify(e),a.modalFilmWatched.textContent=o?"REMOVED FORM WATCHED":"ADD TO WATCHED",a.modalFilmQueue.textContent=i?"REMOVED FORM QUEUE":"ADD TO QUEUE"}(e))),document.body.style.overflow="hidden",c.classList.remove("is-hidden"),document.addEventListener("keydown",u)}})),s.addEventListener("click",d),c.addEventListener("click",(function(e){e.currentTarget===e.target&&d()}));document.querySelector(".modal-film");const m=document.querySelector(".button-watched"),f=document.querySelector(".button-queue");m.addEventListener("click",(function(t){const n=JSON.parse(t.target.dataset.info);console.log(t.target.dataset.info);let o=localStorage.getItem("watch");console.log(o),o=o?JSON.parse(o):[];o.find((e=>e.id===n.id))?(o=o.filter((e=>e.id!==n.id)),a.modalFilmWatched.textContent="ADD TO WATCH",e(i).Notify.failure("Film remove from watch")):(o.push(n),a.modalFilmWatched.textContent="REMOVE FROM WATCH",e(i).Notify.success("Film add to watch"));localStorage.setItem("watch",JSON.stringify(o))})),f.addEventListener("click",(function(t){const n=JSON.parse(t.target.dataset.info);console.log(t);let o=localStorage.getItem("queue");console.log(o),o=o?JSON.parse(o):[];o.find((e=>e.id===n.id))?(o=o.filter((e=>e.id!==n.id)),a.modalFilmQueue.textContent="ADD TO QUEUE",e(i).Notify.failure("Film remove from watch")):(o.push(n),a.modalFilmQueue.textContent="REMOVE FROM QUEUE",e(i).Notify.success("Film add to queue"));localStorage.setItem("queue",JSON.stringify(o))}));const h=new class{fetchPopularMovies(){const e=`https://api.themoviedb.org/3/trending/movie/day?api_key=cf7103a04560136cfec7834a7d0f8600&page=${this.page}`;return fetch(e).then((e=>e.json()))}fetchMoviesByRequest(){const e=`https://api.themoviedb.org/3/search/movie?api_key=cf7103a04560136cfec7834a7d0f8600&language=en-US&query=${this.searchQuery}&page=${this.page}&include_adult=false`;return fetch(e).then((e=>e.json()))}fetchMovieDetails(e){return fetch(`https://api.themoviedb.org/3/movie/${e}?api_key=cf7103a04560136cfec7834a7d0f8600&language=en-US`).then((e=>e.json())).then((e=>e))}fatchTrailerSearch(e){return fetch(`https://api.themoviedb.org/3/movie/${e}/videos?api_key=cf7103a04560136cfec7834a7d0f8600&language=en-US`).then((e=>e.json())).then((e=>e))}incrementPage(){this.page+=1}resetPage(){this.page=1}get query(){return this.searchQuery}set query(e){this.searchQuery=e}clearInput(){this.searchQuery.innerHTML=""}pagination(e){this.page=e}constructor(){this.page=1,this.searchQuery=""}};console.log(h);const g=document.querySelector("#search-form");document.querySelector(".container"),document.querySelector(".search-form__input"),document.querySelector(".search-form__button");let p,y=1;function v(e){return e.map((e=>{for(let t=0;t<e.genre_ids.length;t++)b(e.genre_ids[t])?(e.genre_ids[t]=` ${b(e.genre_ids[t])}`,e.genre_ids.length>2&&e.genre_ids.splice(2,5," Other")):(e.genre_ids[t]=" Other genre",e.genre_ids.length>2&&e.genre_ids.splice(2,5," Other"));return e.release_date?e.release_date=e.release_date.slice(0,4):e.first_air_date&&(e.release_date=e.first_air_date.slice(0,4)),e.original_title||(e.original_title=e.name),e.poster_path?e.poster_path="https://image.tmdb.org/t/p/original/"+e.poster_path:e.poster_path="https://w.zhinka.tv/templates/Default/dleimages/no_image.jpg",e}))}function b(e){let t;return[{id:28,name:"Action"},{id:12,name:"Adventure"},{id:16,name:"Animation"},{id:35,name:"Comedy"},{id:80,name:"Crime"},{id:99,name:"Documentary"},{id:18,name:"Drama"},{id:10751,name:"Family"},{id:14,name:"Fantasy"},{id:36,name:"History"},{id:27,name:"Horror"},{id:10402,name:"Music"},{id:9648,name:"Mystery"},{id:10749,name:"Romance"},{id:878,name:"Science Fiction"},{id:10770,name:"TV Movie"},{id:53,name:"Thriller"},{id:10752,name:"War"},{id:37,name:"Western"}].forEach((n=>{e==n.id&&(t=n.name)})),t}function _(e){const t=w(e);refs.gallery.insertAdjacentHTML("beforeend",movieMarkup(t))}function w(e){return e.map((({first_air_date:e,id:t,name:n,backdrop_path:o,original_title:r,genre_ids:i,poster_path:a,release_date:l})=>({first_air_date:e,id:t,name:n,backdrop_path:o,original_title:r,genre_ids:i,poster_path:a,release_date:l,dataMovie:JSON.stringify({first_air_date:e,id:t,name:n,backdrop_path:o,original_title:r,genre_ids:i,poster_path:a,release_date:l})})))}function L(){refs.preloader.classList.contains("done")||refs.preloader.classList.add("done")}g.addEventListener("submit",(function(e){if(e.preventDefault(),h.query=e.currentTarget.elements.query.value,""===h.query.trim())return toastr.warning("Пожалуйста, введите ваш запроc");refs.gallery.innerHTML="",function(e){e.currentTarget.elements.query.value=""}(e),refs.pageList.innerHTML="",refs.preloader.classList.remove("done"),h.resetPage(),y=1,h.fetchMoviesByRequest().then((e=>(p=e.total_pages,refs.lastBtn.textContent=p,init(),e.results))).then((e=>{e.length<1&&(toastr.error("Фильм не найден! Измените ввод и повторите попытку"),h.query="",h.fetchPopularMovies().then((e=>(p=e.total_pages,refs.lastBtn.textContent=p,init(),e.results))).then((e=>{_(v(w(e))),setTimeout(L,200)})).catch((e=>console.log(e)))),_(v(w(e))),setTimeout(L,200)})).catch((e=>console.log(e)))}));const S={openFooterModal:document.querySelector('[data-action="open-lightbox"]'),closeFooterModal:document.querySelector('[data-action="close-lightbox"]'),lightboxFooterModal:document.querySelector(".js-lightbox"),backdropClick:document.querySelector(".lightbox"),body:document.querySelector("body")};function E(){window.removeEventListener("keydown",q),S.lightboxFooterModal.classList.add("visually-hidden"),S.body.classList.remove("on-scroll")}function q(e){"Escape"===e.code&&(E(),S.body.classList.remove("on-scroll"))}S.openFooterModal.addEventListener("click",(function(){window.addEventListener("keydown",q),S.lightboxFooterModal.classList.remove("visually-hidden"),S.body.classList.add("on-scroll")})),S.closeFooterModal.addEventListener("click",E),S.backdropClick.addEventListener("click",(function(e){e.currentTarget===e.target&&(E(),S.body.classList.remove("on-scroll"))}));const x=document.querySelector(".card");let F;function M(e){e.results.map((e=>{let t=new Date(e.release_date).getFullYear(),n=function(e){let t=[];return e.forEach((e=>{t.push(F.find((t=>t.id===e)).name)})),t}(e.genre_ids);return x.innerHTML+=`<li class="card__item item">\n\n                  <a class="card__link link" href="#" id="${e.id}" data-id="${e.id}" data-film-open>\n                    <div class="card__thumb">\n                      <img class="card__img"                      \n                        sizes="(min-width: 1200px) 370px, (min-width: 768px) 354px, (max-width: 767px) 450px, 100vw"\n                        src='https://www.themoviedb.org/t/p/w500/${e.poster_path}'\n                        alt="tehnocryak"\n                        width="100%"\n                        class="card__img"\n                      />\n                    </div>\n                    <div class="card__meta">\n                      <h2 class="card__title">${e.original_title}</h2>\n                      <p class="card__info">${n} | ${t}</p>\n                    </div>\n                  </a>\n                </li>`}))}fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=177f83f5259c7f846e561f4715bd03a4&language=en-US").then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()})).then((e=>(F=e.genres,F))).catch((e=>console.log(e))),window.onload=function(){document.body.classList.add("loaded_hiding"),window.setTimeout((function(){document.body.classList.add("loaded"),document.body.classList.remove("loaded_hiding")}),500)};var T={};T=function e(t,n,o){function r(a,l){if(!n[a]){if(!t[a]){var c=void 0;if(!l&&c)return c(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var d=n[a]={exports:{}};t[a][0].call(d.exports,(function(e){return r(t[a][1][e]||e)}),d,d.exports,e,t,n,o)}return n[a].exports}for(var i=void 0,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.create=n.visible=void 0;var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.createElement("div");return n.innerHTML=e.trim(),!0===t?n.children:n.firstChild},r=function(e,t){var n=e.children;return 1===n.length&&n[0].tagName===t},i=function(e){return null!=(e=e||document.querySelector(".basicLightbox"))&&!0===e.ownerDocument.body.contains(e)};n.visible=i,n.create=function(e,t){var n=function(e,t){var n=o('\n\t\t<div class="basicLightbox '.concat(t.className,'">\n\t\t\t<div class="basicLightbox__placeholder" role="dialog"></div>\n\t\t</div>\n\t')),i=n.querySelector(".basicLightbox__placeholder");e.forEach((function(e){return i.appendChild(e)}));var a=r(i,"IMG"),l=r(i,"VIDEO"),c=r(i,"IFRAME");return!0===a&&n.classList.add("basicLightbox--img"),!0===l&&n.classList.add("basicLightbox--video"),!0===c&&n.classList.add("basicLightbox--iframe"),n}(e=function(e){var t="string"==typeof e,n=e instanceof HTMLElement==1;if(!1===t&&!1===n)throw new Error("Content must be a DOM element/node or string");return!0===t?Array.from(o(e,!0)):"TEMPLATE"===e.tagName?[e.content.cloneNode(!0)]:Array.from(e.children)}(e),t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==(e=Object.assign({},e)).closable&&(e.closable=!0),null==e.className&&(e.className=""),null==e.onShow&&(e.onShow=function(){}),null==e.onClose&&(e.onClose=function(){}),"boolean"!=typeof e.closable)throw new Error("Property `closable` must be a boolean");if("string"!=typeof e.className)throw new Error("Property `className` must be a string");if("function"!=typeof e.onShow)throw new Error("Property `onShow` must be a function");if("function"!=typeof e.onClose)throw new Error("Property `onClose` must be a function");return e}(t)),a=function(e){return!1!==t.onClose(l)&&function(e,t){return e.classList.remove("basicLightbox--visible"),setTimeout((function(){return!1===i(e)||e.parentElement.removeChild(e),t()}),410),!0}(n,(function(){if("function"==typeof e)return e(l)}))};!0===t.closable&&n.addEventListener("click",(function(e){e.target===n&&a()}));var l={element:function(){return n},visible:function(){return i(n)},show:function(e){return!1!==t.onShow(l)&&function(e,t){return document.body.appendChild(e),setTimeout((function(){requestAnimationFrame((function(){return e.classList.add("basicLightbox--visible"),t()}))}),10),!0}(n,(function(){if("function"==typeof e)return e(l)}))},close:a};return l}},{}]},{},[1])(1);i=r("eWCmQ");a.modalTrailerWatch.addEventListener("click",(function(e){e.preventDefault();!function(e){(function(e){return fetch(`https://api.themoviedb.org/3/movie/${e}/videos?api_key=0f09f0e29eb26a1e28b4809ac59dbd60`).then((e=>{if(!e.ok)throw new Error;return e.json()})).catch((e=>i.Notify.failure("Sorry, something goes wrong. Please, try again")))})(e).then((e=>{const t=e.results.filter((e=>e.official))[0].key,n=T.create(`\n    <iframe src="https://www.youtube.com/embed/${t}" width="560" height="315" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>\n`);n.show(),function(e){document.querySelector(".basicLightbox--iframe").insertAdjacentHTML("afterbegin",'<button\n        type="button"\n        class="modal-film__btn trailer-btn"\n        data-trailer-close\n        >\n        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M8 8L22 22" stroke="black" stroke-width="2"/>\n        <path d="M8 22L22 8" stroke="black" stroke-width="2"/>\n        </svg>\n        </button>\n    ');document.querySelector("[data-trailer-close]").addEventListener("click",(t=>{e.close()}))}(n)}))}(a.modalFilmId.textContent)}));const k=new class{fetchPopularMovies(){const e=`https://api.themoviedb.org/3/trending/movie/day?api_key=0f09f0e29eb26a1e28b4809ac59dbd60&page=${this.page}`;return fetch(e).then((e=>e.json()))}incrementPage(){this.page+=1}resetPage(){this.page=1}get query(){return this.searchQuery}set query(e){this.searchQuery=e}clearInput(){this.searchQuery.innerHTML=""}pagination(e){this.page=e}constructor(){this.page=1,this.searchQuery=""}};let C,O=1;function D(){k.fetchPopularMovies().then((e=>{C=e.total_pages,a.lastBtn.textContent=C,a.prevBtn.disabled=1===O,a.nextBtn.disabled=O===C,a.firstPage.hidden=O<4,a.lastPage.hidden=O>C-3,function(){const e=O+2;for(let t=O-2;t<=e;t+=1)t>0&&t<=C&&a.pageList.insertAdjacentHTML("beforeend",`<li class="pages-item"><button type="button" class="pagination-btn">${t}</button></li>`)}(),function(){let e=a.pageList.querySelectorAll("button");for(let t=0;t<e.length;t+=1)Number(e[t].textContent)===O&&e[t].classList.add("active-btn")}(),M(e)})).catch((e=>console.log(e)))}a.paginationList.addEventListener("click",(function(e){if(e.preventDefault(),"BUTTON"!==e.target.nodeName)return;a.gallery.innerHTML="",a.pageList.innerHTML="",O=Number(e.target.textContent),k.pagination(O),k.query?searchFetch():D()})),a.prevBtn.addEventListener("click",(function(e){e.preventDefault(),O>1&&(O-=1);a.gallery.innerHTML="",a.pageList.innerHTML="",k.pagination(O),k.query?searchFetch():D()})),a.nextBtn.addEventListener("click",(function(e){e.preventDefault(),O!==C&&(O+=1);a.gallery.innerHTML="",a.pageList.innerHTML="",k.pagination(O),k.query?searchFetch():D()})),k.pagination(O),D();
//# sourceMappingURL=index.8ff8878d.js.map
